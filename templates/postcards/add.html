{% extends "base.html" %}

{% block title %}Add New Postcard | Postcard Database{% endblock %}

{% block content %}
<section class="postcard-form">
    <h1>Add New Postcard</h1>
    
    <form action="{{ url_for('add_postcard') }}" method="post" enctype="multipart/form-data">
        <div class="form-group">
            <label for="title">Title *</label>
            <input type="text" id="title" name="title" required>
        </div>
        
        <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description" rows="5"></textarea>
        </div>
        
        <div class="form-row">
            <div class="form-group half">
                <label for="era">Era</label>
                <select id="era" name="era">
                    <option value="">-- Select Era --</option>
                    {% for era in eras %}
                        <option value="{{ era }}">{{ era }}</option>
                    {% endfor %}
                </select>
            </div>
            
            <div class="form-group half">
                <label for="type">Type</label>
                <select id="type" name="type">
                    <option value="">-- Select Type --</option>
                    {% for type in types %}
                        <option value="{{ type }}">{{ type }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
        
        <div class="form-group">
            <label for="manufacturer">Manufacturer</label>
            <input type="text" id="manufacturer" name="manufacturer">
        </div>
        
        <div class="form-row checkboxes">
            <div class="form-group checkbox">
                <input type="checkbox" id="is_posted" name="is_posted">
                <label for="is_posted">Postcard has been posted (used)</label>
            </div>
            
            <div class="form-group checkbox">
                <input type="checkbox" id="is_written" name="is_written">
                <label for="is_written">Postcard has writing on it</label>
            </div>
        </div>
        
        <div class="form-group">
            <label for="tags">Tags (comma separated)</label>
            <input type="text" id="tags" name="tags" placeholder="vintage, nature, europe, etc.">
        </div>
        
        <div class="form-row">
            <div class="form-group half">
                <label for="front_image">Front Image</label>
                <div class="image-upload">
                    <input type="file" id="front_image" name="front_image" accept="image/*">
                    <div class="image-preview" id="front-preview">
                        <div class="placeholder">No image selected</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group half">
                <label for="back_image">Back Image</label>
                <div class="image-upload">
                    <input type="file" id="back_image" name="back_image" accept="image/*">
                    <div class="image-preview" id="back-preview">
                        <div class="placeholder">No image selected</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn primary">Add Postcard</button>
            <a href="{{ url_for('list_postcards') }}" class="btn secondary">Cancel</a>
        </div>
    </form>
</section>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Front image preview
        const frontInput = document.getElementById('front_image');
        const frontPreview = document.getElementById('front-preview');
        
        frontInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    frontPreview.innerHTML = `<img src="${e.target.result}" alt="Front Image Preview">`;
                }
                
                reader.readAsDataURL(this.files[0]);
            } else {
                frontPreview.innerHTML = '<div class="placeholder">No image selected</div>';
            }
        });
        
        // Back image preview
        const backInput = document.getElementById('back_image');
        const backPreview = document.getElementById('back-preview');
        
        backInput.addEventListener('change', function() {
            if (this.files && this.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    backPreview.innerHTML = `<img src="${e.target.result}" alt="Back Image Preview">`;
                }
                
                reader.readAsDataURL(this.files[0]);
            } else {
                backPreview.innerHTML = '<div class="placeholder">No image selected</div>';
            }
        });
    });
</script>
{% endblock %}